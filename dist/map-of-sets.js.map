{"version":3,"file":"map-of-sets.js","sources":["../source/index.js"],"sourcesContent":["\r\nexport class MapOfSets {\r\n  constructor() {\r\n    this.storage = new Map();\r\n  }\r\n\r\n  /**\r\n   * Check if key exists\r\n   * @param {*} key\r\n   */\r\n  has(key) {\r\n    const values = this.storage.get(key);\r\n\r\n    return values && values.size;\r\n  }\r\n\r\n  /**\r\n   * Check if value exists for key\r\n   * @param {*} key\r\n   * @param {*} value\r\n   */\r\n  hasValue(key, value) {\r\n    const values = this.storage.get(key);\r\n\r\n    return values && values.has(value);\r\n  }\r\n\r\n  /**\r\n   * Get Set of values for key\r\n   * @param {*} key\r\n   */\r\n  get(key) {\r\n    return this.storage.get(key);\r\n  }\r\n\r\n  /**\r\n   * List values for key, returns empty array if no key nor values stored\r\n   * @param {*} key\r\n   */\r\n  list(key) {\r\n    const values = this.storage.get(key);\r\n\r\n    return values ? Array.from(values) : [];\r\n  }\r\n\r\n  /**\r\n   * Call callback for each value of each key\r\n   *  callback (value:*, key:*, storage:*):void\r\n   * @param {Function} callback\r\n   */\r\n  forEach(callback) {\r\n    this.storage.forEach((values, key) => values.forEach((value) => callback(value, key, this)));\r\n  }\r\n\r\n  /**\r\n   * Call callback function for each value of specified key\r\n   *  callback (value:*, key:*, storage:*):void\r\n   * @param {*} key\r\n   * @param {Function} callback\r\n   */\r\n  eachValue(key, callback) {\r\n    const values = this.storage.get(key);\r\n\r\n    if (values) {\r\n      values.forEach((value) => callback(value, key, this));\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Add to new value to key.\r\n   * @param {*} key\r\n   * @param {*} value\r\n   */\r\n  add(key, value) {\r\n    if (!value) return;\r\n    const values = this.storage.get(key);\r\n\r\n    if (values) {\r\n      values.add(value);\r\n    } else {\r\n      this.storage.set(key, new Set([value]));\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Replace all values for key\r\n   * @param {*} key\r\n   * @param {Set} types\r\n   */\r\n  set(key, values) {\r\n    if (!values || values.size === 0) {\r\n      this.remove(key);\r\n      return;\r\n    }\r\n\r\n    this.storage.set(key, new Set(values));\r\n  }\r\n\r\n  /**\r\n   * Remove all values for key\r\n   * @param {*} key\r\n   */\r\n  remove(key) {\r\n    this.storage.delete(key);\r\n  }\r\n\r\n  /**\r\n   * Remove single value from key\r\n   * @param {*} key\r\n   * @param {*} value\r\n   */\r\n  removeValue(key, value) {\r\n    const values = this.storage.get(key);\r\n\r\n    if (values) {\r\n      values.delete(value);\r\n\r\n      if (!values.size) {\r\n        this.remove(key);\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clone all key-value stores\r\n   */\r\n  clone() {\r\n    const target = new MapOfSets();\r\n    this.storage.forEach((values, key) => target.set(key, new Set(values)));\r\n\r\n    return target;\r\n  }\r\n}\r\n\r\nexport const createMapOfSets = () => new MapOfSets();\r\n\r\nexport default MapOfSets;\r\n"],"names":["MapOfSets","constructor","storage","Map","has","key","values","get","size","hasValue","value","list","Array","from","forEach","callback","eachValue","add","set","Set","remove","delete","removeValue","clone","target","createMapOfSets"],"mappings":"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"}